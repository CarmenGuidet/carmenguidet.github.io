---
layout: page
subheadline: Experimenta desde un ordenador üë©‚Äçüíª
title:  "Experimento 5: Crear un Broker MQTT üõúüè†"
teaser: "Explorando la comunicaci√≥n en IoT mediante la creaci√≥n de un Broker MQTT"
tags:
    - IoT
    - telematica
    - mqtt
    - terminal 
    - casa
categories:
    - experimenta
---

## Descripci√≥n del experimento
Este experimento consiste en instalar y configurar un Broker MQTT, un componente clave para facilitar la comunicaci√≥n entre dispositivos IoT. A trav√©s de esta actividad, exploraremos conceptos fundamentales de redes, mensajer√≠a y seguridad en sistemas de comunicaci√≥n digital.

### Tema
- **Tema objetivo:** Comunicaciones en IoT y protocolos de red.

### Duraci√≥n estimada
- **Tiempo de duraci√≥n del experimento:** Aproximadamente 45 minutos.

### Edades Objetivo
- **Edad recomendada:** A partir de 15 a√±os (con conocimientos b√°sicos de redes y sistemas operativos).

### Est√°ndares
- Introducir a los estudiantes en el uso de protocolos de comunicaci√≥n IoT.
- Desarrollar habilidades pr√°cticas en la instalaci√≥n y configuraci√≥n de software de red.
- Fomentar la comprensi√≥n de la importancia de la seguridad y la eficiencia en sistemas de comunicaci√≥n digital.

## Preparaci√≥n

### Materiales

- Un ordenador con acceso a Internet.
- Sistema operativo Linux, Windows o macOS.
- Software necesario:
  - **Mosquitto:** Un Broker MQTT de c√≥digo abierto.

### Recursos de apoyo

- Documentaci√≥n oficial de Mosquitto: [mosquitto.org](https://mosquitto.org/)

## Instrucciones

### Pasos

#### Instalaci√≥n de Mosquitto:

##### En Linux (Debian/Ubuntu):

1. **Actualizar los repositorios del sistema:**

   - Abre la Terminal (`Ctrl + Alt + T`) y escribe:
     `sudo apt update`

2. **Instalar Mosquitto:**

   - En la Terminal, ejecuta:
    `sudo apt install mosquitto mosquitto-clients`

3. **Iniciar el servicio Mosquitto:**

   - Escribe el siguiente comando para iniciar el servicio:
    `sudo systemctl start mosquitto`
   - Para que el servicio se inicie autom√°ticamente con cada reinicio del sistema, ejecuta:
    `sudo systemctl enable mosquitto`

##### En Windows:

1. **Descargar el instalador de Mosquitto:**

   - Visita [mosquitto.org/download](https://mosquitto.org/download/) y descarga la versi√≥n para Windows.

2. **Instalar Mosquitto:**

   - Ejecuta el archivo descargado y sigue los pasos del asistente de instalaci√≥n.

3. **Iniciar Mosquitto:**

   - Abre una ventana de `cmd` y navega a la carpeta de instalaci√≥n de Mosquitto.
   - Ejecuta el comando: `mosquitto`


##### En macOS:

1. **Instalar Homebrew (si no est√° instalado):**

   - Abre la Terminal (`Aplicaciones` > `Utilidades` > `Terminal`) y ejecuta:

     `/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)`

2. **Instalar Mosquitto:**

   - Escribe en la Terminal:

     `brew install mosquitto`

3. **Iniciar el servicio Mosquitto:**

   - Ejecuta el siguiente comando:
    `brew services start mosquitto`

#### Configuraci√≥n para permitir la publicaci√≥n p√∫blica

Para permitir que cualquier persona pueda publicar mensajes en el Broker MQTT sin autenticaci√≥n, debes ajustar la configuraci√≥n del archivo de Mosquitto. **Nota: Esta configuraci√≥n puede presentar riesgos de seguridad.**

1. **Localiza el archivo de configuraci√≥n de Mosquitto:**

   - En Linux, el archivo de configuraci√≥n generalmente se encuentra en `/etc/mosquitto/mosquitto.conf`.
   - En Windows y macOS, el archivo puede estar en el directorio de instalaci√≥n de Mosquitto, por ejemplo, `C:\Program Files\mosquitto\mosquitto.conf` o `/usr/local/etc/mosquitto/mosquitto.conf`.

2. **Edita el archivo de configuraci√≥n:**

   - Abre el archivo de configuraci√≥n con un editor de texto. Por ejemplo, en Linux puedes usar `nano`:
     `sudo nano /etc/mosquitto/mosquitto.conf`
   - En Windows, abre el archivo con un editor de texto como Notepad++.

3. **Configura la pol√≠tica de acceso:**

   - A√±ade o modifica las siguientes l√≠neas para permitir la publicaci√≥n p√∫blica. Busca y ajusta las configuraciones relacionadas con los permisos:

     `allow_anonymous true`
     `listener 1883`

   - La opci√≥n `allow_anonymous true` permite la conexi√≥n y publicaci√≥n sin autenticaci√≥n. El puerto `1883` es el puerto por defecto para MQTT.

4. **Guarda los cambios y reinicia el Broker:**

   - En Linux, guarda el archivo y reinicia Mosquitto con:
     `sudo systemctl restart mosquitto`
   - En Windows y macOS, reinicia Mosquitto desde el servicio o la aplicaci√≥n correspondiente.

Esta configuraci√≥n es esencial si queremos usar nuestro ordenador como broker MQTT, y recibir o enviar informaci√≥n de dispositivos externos como puede ser otro ordenador, un ESP32 o nuestro telefono movil.

#### Configuraci√≥n b√°sica:

1. **Verificaci√≥n del Broker MQTT:**

   - Abre una nueva ventana de Terminal o `cmd` y suscr√≠bete a un tema de prueba:
    `mosquitto_sub -h localhost -t prueba`

   - En otra ventana de Terminal, publica un mensaje en el mismo tema:
    `mosquitto_pub -h localhost -t prueba -m "¬°Hola desde MQTT!"`
     
   - Si el Broker est√° funcionando correctamente, deber√≠as ver el mensaje en la primera ventana.

### Actividades complementarias (opcional)

- **Configuraci√≥n de autenticaci√≥n y seguridad:** Explora c√≥mo agregar autenticaci√≥n de usuarios y configuraciones de seguridad b√°sicas para proteger tu Broker MQTT.
- **Conectar dispositivos IoT:** Configura un dispositivo IoT, como un microcontrolador, para que se comunique con tu Broker MQTT, enviando y recibiendo datos en tiempo real.
- **Aplicaciones educativas:** Investiga c√≥mo MQTT se utiliza en entornos educativos, como laboratorios de f√≠sica o simulaciones de ciudades inteligentes.

### Recursos adicionales

- **Documentaci√≥n adicional de MQTT:** Lee m√°s sobre las capacidades de MQTT y su uso en diferentes industrias en la [documentaci√≥n oficial de MQTT](https://mqtt.org/).